{"ast":null,"code":"var _jsxFileName = \"/Users/huy8bit/Desktop/DRIVE/DEV/application nlp/PROJECT/Dating-GPT/UI/src/pages/Chat.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { Heading, Highlight, chakra, shouldForwardProp } from \"@chakra-ui/react\";\nimport Header from \"../components/Header\";\nimport Conversation from \"../components/Conversation\";\nimport { getPickUpLine, getRoot } from '../Api.js';\nimport ProfileHelper from \"../helper/ProfileHelper\";\nimport { motion, isValidMotionProp } from \"framer-motion\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst AnimationBox = chakra(motion.div, {\n  shouldForwardProp: prop => isValidMotionProp(prop) || shouldForwardProp(prop)\n});\n_c = AnimationBox;\nconst Chat = () => {\n  _s();\n  const [profiles, setProfiles] = useState(null);\n  const [history, setHistory] = useState([]);\n  const [choices, setChoices] = useState([]);\n  const [hideConversation, setHideConversation] = useState(true);\n  const [fetchError, setFetchError] = useState(null);\n  const [stopAiConversation, setStopAiConversation] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(null);\n\n  // Initial call to backend to start it up\n  useEffect(() => {\n    getRoot();\n  }, []);\n  useEffect(() => {\n    if (!hideConversation) {\n      scrollToBottom();\n    }\n  }, [hideConversation, scrollToBottom]);\n  useEffect(() => {\n    if (history.length >= 4) {\n      setStopAiConversation(true);\n      return;\n    }\n    if (ProfileHelper.areFilledProfiles(profiles)) {\n      console.log(\"Fetching choices\");\n      setHideConversation(false);\n      fetchChoices().then(choices => {\n        setChoices(choices);\n      });\n    }\n  }, [profiles, history]);\n  const handleConversationStart = profiles => {\n    if (!ProfileHelper.areFilledProfiles(profiles)) {\n      setErrorMessage('Please add at least one information for each profile');\n    } else {\n      setErrorMessage(null);\n      setHistory([]);\n      setChoices([]);\n      setProfiles(profiles);\n    }\n  };\n  function handleChoiceSelection(choice) {\n    setHistory([...history, {\n      sender: ProfileHelper.getNextProfileIdByHistory(history),\n      msg: choice\n    }]);\n    setChoices([]);\n  }\n  function scrollToBottom() {\n    window.scrollTo({\n      top: window.scrollY + window.innerHeight,\n      behavior: 'smooth'\n    });\n  }\n  async function fetchChoices() {\n    const profileId = ProfileHelper.getNextProfileIdByHistory(history);\n    try {\n      const {\n        choices\n      } = await getPickUpLine(profiles, profileId, history);\n      setFetchError(null);\n      return choices !== null && choices !== void 0 ? choices : [];\n    } catch (error) {\n      console.error(`${error}`);\n      setFetchError(error);\n      return [];\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(AnimationBox, {\n      as: motion.div,\n      transition: {\n        ease: 'easeOut',\n        duration: 0.5\n      },\n      initial: {\n        y: '-20',\n        opacity: 0\n      },\n      animate: {\n        y: 0,\n        opacity: 1\n      },\n      children: /*#__PURE__*/_jsxDEV(Heading, {\n        as: \"h1\",\n        size: \"2xl\",\n        mb: 10,\n        children: /*#__PURE__*/_jsxDEV(Highlight, {\n          query: 'AI',\n          styles: {\n            px: '2',\n            py: '1',\n            rounded: 'full',\n            bg: 'red.100'\n          },\n          children: \"DAITING.BETTER\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AnimationBox, {\n      as: motion.div,\n      transition: {\n        ease: 'easeOut',\n        duration: 0.5,\n        delay: 0.3\n      },\n      initial: {\n        y: -20,\n        opacity: 0\n      },\n      animate: {\n        y: 0,\n        opacity: 1\n      },\n      children: /*#__PURE__*/_jsxDEV(Header, {\n        onConversationStart: handleConversationStart,\n        errorMessage: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(AnimationBox, {\n      as: motion.div,\n      transition: {\n        ease: 'easeOut',\n        duration: 0.5,\n        delay: 0.6\n      },\n      initial: {\n        y: -20,\n        opacity: 0\n      },\n      animate: {\n        y: 0,\n        opacity: 1\n      },\n      children: /*#__PURE__*/_jsxDEV(Conversation, {\n        choices: choices,\n        history: history,\n        onChoiceSelection: handleChoiceSelection,\n        hidden: hideConversation,\n        fetchError: fetchError,\n        stopAiConversation: stopAiConversation\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Chat, \"B6pASwjktRtG2u4zm5PgXc92KBg=\");\n_c2 = Chat;\nexport default Chat;\nvar _c, _c2;\n$RefreshReg$(_c, \"AnimationBox\");\n$RefreshReg$(_c2, \"Chat\");","map":{"version":3,"names":["useState","useEffect","Heading","Highlight","chakra","shouldForwardProp","Header","Conversation","getPickUpLine","getRoot","ProfileHelper","motion","isValidMotionProp","jsxDEV","_jsxDEV","Fragment","_Fragment","AnimationBox","div","prop","_c","Chat","_s","profiles","setProfiles","history","setHistory","choices","setChoices","hideConversation","setHideConversation","fetchError","setFetchError","stopAiConversation","setStopAiConversation","errorMessage","setErrorMessage","scrollToBottom","length","areFilledProfiles","console","log","fetchChoices","then","handleConversationStart","handleChoiceSelection","choice","sender","getNextProfileIdByHistory","msg","window","scrollTo","top","scrollY","innerHeight","behavior","profileId","error","children","as","transition","ease","duration","initial","y","opacity","animate","size","mb","query","styles","px","py","rounded","bg","fileName","_jsxFileName","lineNumber","columnNumber","delay","onConversationStart","onChoiceSelection","hidden","_c2","$RefreshReg$"],"sources":["/Users/huy8bit/Desktop/DRIVE/DEV/application nlp/PROJECT/Dating-GPT/UI/src/pages/Chat.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { Heading, Highlight, chakra, shouldForwardProp } from \"@chakra-ui/react\";\nimport Header from \"../components/Header\";\nimport Conversation from \"../components/Conversation\";\nimport { getPickUpLine, getRoot } from '../Api.js';\nimport ProfileHelper from \"../helper/ProfileHelper\";\nimport { motion, isValidMotionProp } from \"framer-motion\"\n\nconst AnimationBox = chakra(motion.div, {\n  shouldForwardProp: (prop) => isValidMotionProp(prop) || shouldForwardProp(prop),\n});\n\nconst Chat = () => {\n  const [profiles, setProfiles] = useState(null);\n  const [history, setHistory] = useState([]);\n  const [choices, setChoices] = useState([]);\n  const [hideConversation, setHideConversation] = useState(true);\n  const [fetchError, setFetchError] = useState(null);\n  const [stopAiConversation, setStopAiConversation] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(null);\n\n  // Initial call to backend to start it up\n  useEffect(() => {\n    getRoot();\n  }, []);\n\n  useEffect(() => {\n    if (!hideConversation) {\n      scrollToBottom();\n    }\n  }, [hideConversation, scrollToBottom]);\n\n  useEffect(() => {\n    if (history.length >= 4) {\n      setStopAiConversation(true);\n      return;\n    }\n    \n    if (ProfileHelper.areFilledProfiles(profiles)) {\n      console.log(\"Fetching choices\");\n      setHideConversation(false);\n      fetchChoices().then((choices) => {\n        setChoices(choices);\n      });\n    }\n  }, [profiles, history]);\n\n  const handleConversationStart = (profiles) => {\n    if (!ProfileHelper.areFilledProfiles(profiles)) {\n      setErrorMessage('Please add at least one information for each profile');\n    } else {\n      setErrorMessage(null);\n      setHistory([]);\n      setChoices([])\n      setProfiles(profiles);\n    }\n  };\n\n  function handleChoiceSelection(choice) {\n    setHistory([...history, {sender: ProfileHelper.getNextProfileIdByHistory(history), msg: choice}]);\n    setChoices([]);\n  }\n\n  function scrollToBottom() {\n    window.scrollTo({\n      top: window.scrollY + window.innerHeight,\n      behavior: 'smooth',\n    });\n  }\n\n  async function fetchChoices() {\n    const profileId = ProfileHelper.getNextProfileIdByHistory(history);\n    try {\n      const {choices} = await getPickUpLine(profiles, profileId, history);\n      setFetchError(null);\n      return choices ?? []\n    } catch (error) {\n      console.error(`${error}`);\n      setFetchError(error);\n      return [];\n    }\n  }\n\n  return (\n    <>\n      <AnimationBox as={motion.div} transition={{ease: 'easeOut', duration: 0.5}} initial={{ y: '-20', opacity: 0 }} animate={{ y: 0, opacity: 1 }}>\n        <Heading as='h1' size='2xl' mb={10}>\n          <Highlight\n            query={'AI'}\n            styles={{ px: '2', py: '1', rounded: 'full', bg: 'red.100' }}\n          >\n            DAITING.BETTER\n          </Highlight>\n        </Heading>\n      </AnimationBox>\n      <AnimationBox as={motion.div} transition={{ease: 'easeOut', duration: 0.5, delay: 0.3}} initial={{ y: -20, opacity: 0 }} animate={{ y: 0, opacity: 1 }}>\n        <Header onConversationStart={handleConversationStart} errorMessage={errorMessage} />\n      </AnimationBox>\n      <AnimationBox as={motion.div} transition={{ease: 'easeOut', duration: 0.5, delay: 0.6}} initial={{ y: -20, opacity: 0 }} animate={{ y: 0, opacity: 1 }}>\n        <Conversation choices={choices} history={history} onChoiceSelection={handleChoiceSelection} hidden={hideConversation} fetchError={fetchError} stopAiConversation={stopAiConversation} />\n      </AnimationBox>\n    </>\n  );\n};\n\nexport default Chat;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}